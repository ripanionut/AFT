import Head from "next/head";
import Layout from "../components/layout";
import { useRef } from "react";

async function createPost(
	enteredTitle,
	enteredLink,
	enteredDescription,
	enteredH1,
	enteredH2,
	enteredH3
) {
	const response = await fetch("/api/add", {
		method: "POST",
		body: JSON.stringify({
			enteredTitle,
			enteredLink,
			enteredDescription,
			enteredH1,
			enteredH2,
			enteredH3,
		}),
		headers: {
			"Content-Type": "application/json",
		},
	});

	const data = await response.json();

	if (!response.ok) {
		throw new Error(data.message || "Something went wrong!");
	}

	return data;
}

export default function Add() {
	const inputTitle = useRef();
	const inputLink = useRef();
	const inputDescription = useRef();
	const inputH1 = useRef();
	const inputH2 = useRef();
	const inputH3 = useRef();

	async function submitHandler(event) {
		event.preventDefault();
		alert("Succes");
		const enteredTitle = inputTitle.current.value;
		const enteredLink = inputLink.current.value;
		const enteredDescription = inputDescription.current.value;
		const enteredH1 = inputH1.current.value;
		const enteredH2 = inputH2.current.value;
		const enteredH3 = inputH3.current.value;

		const result = await createPost(
			enteredTitle,
			enteredLink,
			enteredDescription,
			enteredH1,
			enteredH2,
			enteredH3
		);
	}

	return (
		<div>
			<Head>
				<title>Create Next App</title>
				<meta name="description" content="Generated by create next app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>
			<Layout>
				<form id="myForm" onSubmit={submitHandler} method="POST">
					<div class="bg-indigo-50 min-h-screen md:px-20 pt-10">
						<div class=" bg-white rounded-md px-6 py-10 max-w-2xl mx-auto">
							<h1 class="text-center text-3xl font-bold text-indigo-500 mb-10">
								Aduga Problema in Baza de Date
							</h1>
							<div class="space-y-4">
								<div>
									<label for="title" class="text-lx mr-6 font-serif">
										Titlu:
									</label>
									<input
										ref={inputTitle}
										type="text"
										placeholder="Titlu"
										id="title"
										class="ml-2 outline-none py-1 px-2 text-md border-2 rounded-md"
									/>
								</div>

								<div>
									<label for="title" class="text-lx font-serif">
										Imagine:
									</label>
									<input
										ref={inputLink}
										type="text"
										placeholder="Link *Legatura Directa*"
										id="title"
										class="ml-2 outline-none py-1 px-2 text-md border-2 rounded-md"
									/>
									<a
										target="_blank"
										href="https://postimages.org/"
										class="ml-3 px-4 py-1 mx-auto  rounded-md text-lg font-semibold text-green-100 bg-indigo-600  "
									>
										Add IMG
									</a>
								</div>
								<div>
									<label
										for="description"
										class="block mb-2 text-lg font-serif"
									>
										Descriere:
									</label>
									<textarea
										ref={inputDescription}
										id="description"
										cols="30"
										rows="10"
										placeholder="whrite here.."
										class="w-full font-serif  p-4 text-gray-600 bg-indigo-50 outline-none rounded-md"
									></textarea>
								</div>
								<div>
									<label for="name" class="text-lx font-serif">
										A
									</label>
									<input
										ref={inputH1}
										type="text"
										placeholder="#"
										id="#1"
										class="ml-2 outline-none py-1 px-2 text-md border-2 rounded-md"
									/>
								</div>
								<div>
									<label for="name" class="text-lx font-serif">
										B
									</label>
									<input
										ref={inputH2}
										type="text"
										placeholder="#"
										id="#2"
										class="ml-2 outline-none py-1 px-2 text-md border-2 rounded-md"
									/>
								</div>
								<div>
									<label for="name" class="text-lx font-serif">
										C
									</label>
									<input
										ref={inputH3}
										type="text"
										placeholder="#"
										id="#3"
										class="ml-2 outline-none py-1 px-2 text-md border-2 rounded-md"
									/>
								</div>
								<button class=" px-6 py-2 mx-auto block rounded-md text-lg font-semibold text-indigo-100 bg-indigo-600  ">
									Hit to Add
								</button>
							</div>
						</div>
					</div>
				</form>
			</Layout>
		</div>
	);
}
